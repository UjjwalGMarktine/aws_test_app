#!/bin/bash
# -------------------------------------------
# FastAPI Docker Cleanup & Rebuild Script
# Author: Ujjwal Ghodke
# -------------------------------------------

echo "ğŸ§¹ Stopping running containers..."
docker-compose down

echo "ğŸ§¼ Cleaning up unused Docker resources (images, containers, volumes)..."
docker system prune -a --volumes -f

echo "ğŸ”§ Rebuilding images (no cache)..."
docker-compose build --no-cache

echo "ğŸš€ Starting containers in detached mode..."
docker-compose up -d

echo "âœ… Deployment completed successfully!"
echo "ğŸŒ Your FastAPI app should be accessible on port 80 (http://<your-ec2-public-ip>)"
